import{r as d,j as e}from"./vendor-react-CVtZf1lr.js";import{S as a}from"./account-DbkK4sKH.js";import{f as M,c as S,a as D,b as H,d as v}from"./App-DraFXPFH.js";import"./vendor-supabase-DxPc9Yn3.js";import"./vendor-misc-CRXyoZRO.js";import"./index-CTth5syN.js";import"./vendor-leaflet-KW0ACPqV.js";const $=t=>{switch(t){case"LIVE":return"bg-emerald-500/30 text-emerald-100 border-emerald-300/60";case"RECENT":return"bg-amber-400/30 text-amber-100 border-amber-300/60";default:return"bg-slate-400/25 text-slate-100 border-slate-300/50"}},z=(t,r)=>{if(t===r)return!0;if(!t||!r)return!t&&!r;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s+=1)if(t[s]!==r[s])return!1;return!0},N=t=>t===null?a.weather.noRainData:`${Math.round(t)}%`,K=(t,r)=>{if(t===r)return!0;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s+=1)if(t[s].ts!==r[s].ts||t[s].temperatureC!==r[s].temperatureC||t[s].rainProbability!==r[s].rainProbability||t[s].weatherCode!==r[s].weatherCode||t[s].conditionLabel!==r[s].conditionLabel)return!1;return!0},B=(t,r)=>t===r?!0:!t||!r?!1:t.fetchedAt===r.fetchedAt&&t.expiresAt===r.expiresAt&&t.timezone===r.timezone&&t.current.ts===r.current.ts&&t.current.temperatureC===r.current.temperatureC&&t.current.windKmh===r.current.windKmh&&t.current.rainProbability===r.current.rainProbability&&t.current.weatherCode===r.current.weatherCode&&t.current.isDay===r.current.isDay&&t.current.conditionLabel===r.current.conditionLabel&&K(t.nextHours,r.nextHours),F=({beach:t,isOpen:r,now:s,isFavorite:i,weather:n,weatherLoading:w,weatherUnavailable:k,onClose:m,onToggleFavorite:C,onReport:L,onShare:E})=>{const b=d.useRef(null),p=d.useRef(null),A=t.state==="PRED";if(d.useEffect(()=>{if(!r)return;const l=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=l}},[r]),d.useEffect(()=>{if(!r)return;p.current?.focus();const l=b.current?.querySelectorAll("button, [href], input, select, textarea, [tabindex]:not([tabindex='-1'])"),y=o=>{if(o.key==="Escape"){m();return}if(o.key!=="Tab"||!l||l.length===0)return;const j=l[0],g=l[l.length-1];o.shiftKey&&document.activeElement===j?(o.preventDefault(),g.focus()):!o.shiftKey&&document.activeElement===g&&(o.preventDefault(),j.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[r,m]),!r)return null;const P=t.address?.trim(),R=t.hours?.trim(),x=t.phone?.trim(),c=t.website?.trim(),u=t.services?.filter(Boolean),f=Number.isFinite(t.lat)&&Number.isFinite(t.lng)?`https://www.google.com/maps?q=${t.lat},${t.lng}`:null,h=c?c.startsWith("http")?c:`https://${c}`:null;return e.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-[calc(env(safe-area-inset-top)+16px)]",onClick:m,children:e.jsxs("div",{ref:b,role:"dialog","aria-modal":"true","aria-label":a.aria.beachDetails(t.name),"data-testid":"lido-modal",onClick:l=>l.stopPropagation(),className:"flex max-h-[80svh] w-[min(92vw,560px)] flex-col overflow-hidden rounded-[18px] contrast-guard",children:[e.jsxs("div",{className:"flex items-start justify-between px-6 pt-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex rounded-full border px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.08em] ${$(t.state)}`,children:M(t.state)}),A?e.jsx("span",{className:"text-[11px] br-text-tertiary",children:a.status.predLong}):null]}),e.jsxs("h2",{className:"mt-3 flex items-start gap-2 text-[22px] font-semibold tracking-[-0.01em] br-text-primary",children:[e.jsx("span",{className:"min-w-0 flex-1 break-words",children:t.name}),e.jsx("button",{type:"button",onClick:C,"aria-label":a.aria.toggleFavoriteBeach(t.name,i),"data-testid":"favorite-toggle",className:`br-press inline-flex h-8 w-8 min-h-8 min-w-8 shrink-0 items-center justify-center rounded-full border transition focus-visible:outline focus-visible:outline-1 focus-visible:outline-[color:var(--focus-ring)] focus-visible:outline-offset-1 ${i?"border-amber-300/55 bg-amber-400/20 text-amber-100":"border-white/18 bg-black/40 br-text-tertiary"}`,children:e.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"h-4 w-4 shrink-0",fill:i?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.8",children:e.jsx("path",{d:"M12 2.7l2.8 5.67 6.25.91-4.53 4.42 1.07 6.24L12 17.06 6.4 19.94l1.07-6.24-4.53-4.42 6.25-.91L12 2.7z"})})})]}),e.jsx("p",{className:"text-[13px] br-text-secondary",children:t.region})]}),e.jsx("button",{ref:p,onClick:m,"aria-label":a.aria.closeBeachDetails,className:"br-press rounded-full border border-white/15 bg-black/40 px-3 py-1.5 text-[11px] font-semibold br-text-primary focus-visible:outline focus-visible:outline-1 focus-visible:outline-[color:var(--focus-ring)] focus-visible:outline-offset-1",children:a.actions.close})]}),e.jsxs("div",{className:"flex-1 space-y-4 overflow-y-auto px-6 pb-6 pt-4",children:[e.jsxs("div",{className:"rounded-[12px] border border-white/15 bg-black/30 p-4 text-sm br-text-primary backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:[e.jsx("span",{children:a.labels.crowdStatus}),e.jsx("span",{className:"text-[11px] font-semibold br-text-primary",children:S(t.crowdLevel)})]}),e.jsxs("div",{className:"mt-3 grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"br-text-tertiary",children:a.labels.confidence}),e.jsx("span",{className:"font-semibold",children:D(t.confidence)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"br-text-tertiary",children:a.labels.lastUpdate}),e.jsx("span",{className:"font-semibold",children:H(t.updatedAt,s)})]})]})]}),e.jsxs("div",{"data-testid":"lido-weather",className:"rounded-[12px] border border-white/15 bg-black/30 p-4 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:[e.jsx("span",{children:a.labels.weather}),n?e.jsxs("span",{className:"font-semibold br-text-primary",children:[a.weather.updated," ",v(n.current.ts,n.timezone)]}):null]}),n?e.jsxs("div",{className:"mt-3 grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-[13px] br-text-primary",children:n.current.conditionLabel}),e.jsxs("div",{className:"text-[18px] font-semibold br-text-primary",children:[Math.round(n.current.temperatureC),"°C"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-[12px]",children:[e.jsx("span",{className:"br-text-tertiary",children:a.weather.wind}),e.jsxs("span",{className:"font-semibold br-text-primary",children:[Math.round(n.current.windKmh)," km/h"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-[12px]",children:[e.jsx("span",{className:"br-text-tertiary",children:a.weather.rainProbability}),e.jsx("span",{className:"font-semibold br-text-primary",children:N(n.current.rainProbability)})]}),n.nextHours.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:a.weather.nextHours}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:n.nextHours.map(l=>e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 px-2 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-[11px] br-text-primary",children:[e.jsx("span",{children:v(l.ts,n.timezone)}),e.jsxs("span",{children:[Math.round(l.temperatureC),"°C"]})]}),e.jsx("div",{className:"mt-1 text-[10px] br-text-secondary",children:l.conditionLabel}),e.jsxs("div",{className:"mt-1 text-[10px] br-text-tertiary",children:[a.weather.rainProbability,":"," ",N(l.rainProbability)]})]},l.ts))})]}):null]}):w?e.jsx("p",{className:"mt-3 text-[13px] br-text-secondary",children:a.weather.loading}):k?e.jsx("p",{className:"mt-3 text-[13px] br-text-tertiary",children:a.weather.unavailable}):e.jsx("p",{className:"mt-3 text-[13px] br-text-secondary",children:a.weather.loading})]}),e.jsxs("div",{className:"rounded-[12px] border border-white/15 bg-black/30 p-4 backdrop-blur-sm",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:a.labels.address}),e.jsx("p",{className:"mt-2 text-[13px] br-text-primary",children:P||a.empty.notAvailable}),f?e.jsx("a",{href:f,target:"_blank",rel:"noreferrer",className:"mt-2 inline-flex text-[12px] font-semibold br-text-primary",children:a.actions.openInMaps}):null]}),e.jsxs("div",{className:"rounded-[12px] border border-white/15 bg-black/30 p-4 backdrop-blur-sm",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:a.labels.hours}),e.jsx("p",{className:"mt-2 text-[13px] br-text-primary",children:R||a.empty.toConfirm})]}),e.jsxs("div",{className:"rounded-[12px] border border-white/15 bg-black/30 p-4 backdrop-blur-sm",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:a.labels.usefulInfo}),e.jsxs("div",{className:"mt-3 grid gap-2 text-[13px] br-text-primary",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"br-text-tertiary",children:a.labels.phone}),x?e.jsx("a",{href:`tel:${x}`,className:"font-semibold br-text-primary",children:x}):e.jsx("span",{className:"font-semibold br-text-tertiary",children:a.empty.notAvailable})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"br-text-tertiary",children:a.labels.website}),h?e.jsx("a",{href:h,target:"_blank",rel:"noreferrer",className:"font-semibold br-text-primary",children:c}):e.jsx("span",{className:"font-semibold br-text-tertiary",children:a.empty.notAvailable})]})]}),e.jsx("div",{className:"mt-3",children:u&&u.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(l=>e.jsx("span",{className:"rounded-full border border-white/20 bg-black/40 px-3 py-1 text-[11px] font-semibold br-text-primary",children:l},l))}):e.jsx("p",{className:"text-[13px] br-text-tertiary",children:a.empty.notAvailable})})]})]}),e.jsx("div",{className:"br-hairline border-t bg-black/40 px-6 pb-[calc(env(safe-area-inset-bottom)+16px)] pt-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:L,"data-testid":"report-cta",className:"br-press rounded-[12px] border border-white/25 bg-black/50 px-4 py-3 text-[14px] font-semibold text-slate-50 shadow-[0_10px_24px_rgba(0,0,0,0.45)] backdrop-blur-sm focus-visible:outline focus-visible:outline-1 focus-visible:outline-[color:var(--focus-ring)] focus-visible:outline-offset-1",children:a.actions.report}),e.jsx("button",{onClick:E,className:"br-press rounded-[12px] border border-white/18 bg-black/40 px-4 py-3 text-[14px] font-semibold br-text-primary backdrop-blur-sm focus-visible:outline focus-visible:outline-1 focus-visible:outline-[color:var(--focus-ring)] focus-visible:outline-offset-1",children:a.actions.share})]})})]})})},T=(t,r)=>{if(t.isOpen!==r.isOpen||t.now!==r.now||t.isFavorite!==r.isFavorite||t.weatherLoading!==r.weatherLoading||t.weatherUnavailable!==r.weatherUnavailable||!B(t.weather,r.weather)||t.onClose!==r.onClose||t.onToggleFavorite!==r.onToggleFavorite||t.onReport!==r.onReport||t.onShare!==r.onShare)return!1;const s=t.beach,i=r.beach;return s.id===i.id&&s.name===i.name&&s.region===i.region&&s.state===i.state&&s.crowdLevel===i.crowdLevel&&s.confidence===i.confidence&&s.updatedAt===i.updatedAt&&s.reportsCount===i.reportsCount&&s.lat===i.lat&&s.lng===i.lng&&s.address===i.address&&s.hours===i.hours&&s.phone===i.phone&&s.website===i.website&&z(s.services,i.services)},Q=d.memo(F,T);export{Q as default};
