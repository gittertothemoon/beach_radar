import{r as c,j as r}from"./vendor-react-CVtZf1lr.js";import{S as e}from"./account-DbkK4sKH.js";import"./vendor-supabase-DxPc9Yn3.js";import"./vendor-misc-CRXyoZRO.js";const j=700,E=[{level:1,label:e.crowdLevels[1]},{level:2,label:e.crowdLevels[2]},{level:3,label:e.crowdLevels[3]},{level:4,label:e.crowdLevels[4]}],R=({isOpen:n,beachName:f,userLocation:s,distanceM:i,allowRemoteReports:d,geoStatus:l,geoError:k,onRequestLocation:b,onClose:u,onSubmit:g,submitError:x,submitting:p=!1})=>{const m=c.useRef(null);c.useEffect(()=>{n&&!s&&l==="idle"&&b()},[l,n,b,s]),c.useEffect(()=>{if(!n)return;const t=m.current;if(!t)return;const a=t.querySelectorAll("button, [href], input, select, textarea, [tabindex]:not([tabindex='-1'])");a[0]?.focus();const v=o=>{if(o.key==="Escape"){u();return}if(o.key!=="Tab"||a.length===0)return;const h=a[0],y=a[a.length-1];o.shiftKey&&document.activeElement===h?(o.preventDefault(),y.focus()):!o.shiftKey&&document.activeElement===y&&(o.preventDefault(),h.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[n,u]);const w=c.useMemo(()=>d?!0:!s||i===null?!1:i<=j,[d,i,s]);if(!n)return null;const N=()=>l==="loading"?e.report.locationSearching:d&&(l==="denied"||l==="error"||!s)?e.report.remoteAllowed:l==="denied"?e.report.locationDenied:l==="error"?k??e.report.locationUnavailable:s?i!==null&&i>j?d?e.report.remoteAllowed:e.report.tooFar:i!==null?e.report.nearEnough:"":e.report.locationRequired;return r.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/40 px-4 pb-6 pt-10",children:r.jsxs("div",{ref:m,role:"dialog","aria-modal":"true","aria-label":e.aria.reportBeach(f),"data-testid":"report-modal",className:"w-full max-w-screen-sm rounded-[18px] contrast-guard px-6 pb-[calc(env(safe-area-inset-bottom)+20px)] pt-6",children:[r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-semibold br-text-primary",children:e.report.title}),r.jsx("p",{className:"text-sm br-text-secondary",children:f})]}),r.jsx("button",{onClick:u,"aria-label":e.aria.closeReport,className:"br-press rounded-full border border-white/20 bg-black/40 px-3 py-1.5 text-xs font-semibold br-text-primary focus-visible:outline focus-visible:outline-1 focus-visible:outline-[color:var(--focus-ring)] focus-visible:outline-offset-1",children:e.actions.close})]}),r.jsx("div",{className:"mt-4 rounded-[12px] border border-white/15 bg-black/30 px-4 py-3 text-xs br-text-secondary backdrop-blur-sm",children:N()}),x?r.jsx("div",{"data-testid":"report-error",className:"mt-3 rounded-[12px] border border-rose-300/60 bg-rose-500/25 px-4 py-2 text-xs text-rose-50",children:x}):null,p?r.jsx("div",{className:"mt-3 rounded-[12px] border border-sky-300/60 bg-sky-500/20 px-4 py-2 text-xs text-sky-50",children:e.report.submitting}):null,r.jsx("div",{className:"mt-4 grid grid-cols-2 gap-3",children:E.map(t=>r.jsxs("button",{onClick:()=>g(t.level),disabled:!w||p,"data-testid":`report-level-${t.level}`,className:"br-press rounded-[12px] border border-white/20 bg-black/40 px-3 py-4 text-sm font-semibold br-text-primary transition disabled:cursor-not-allowed disabled:opacity-40 focus-visible:outline focus-visible:outline-1 focus-visible:outline-[color:var(--focus-ring)] focus-visible:outline-offset-1",children:[t.level," â€¢ ",t.label]},t.level))})]})})};export{R as default};
