import{c as v}from"./vendor-supabase-DxPc9Yn3.js";const L={appName:"Where2Beach",actions:{close:"Chiudi",share:"Condividi",report:"Segnala",createAccount:"Crea account",addFavorite:"Aggiungi ai preferiti",removeFavorite:"Rimuovi preferito",reportCrowd:"Segnala affollamento",showAllPins:"Mostra tutti i pin",openInMaps:"Apri su Mappe",clearSearch:"Cancella ricerca",clearSymbol:"X",writeReview:"Scrivi una recensione"},aria:{searchBeaches:"Cerca una spiaggia",clearSearch:"Cancella ricerca",expandBeaches:"Mostra elenco spiagge",myLocation:"La mia posizione",closeBeachDetails:"Chiudi dettagli spiaggia",closeReport:"Chiudi segnalazione",reportBeach:e=>`Segnala ${e}`,beachDetails:e=>`Dettagli ${e}`,toggleFavoriteBeach:(e,i)=>i?`Rimuovi ${e} dai preferiti`:`Aggiungi ${e} ai preferiti`},banners:{limitedData:"Pochi dati recenti. Aiutaci con una segnalazione."},search:{label:"Cerca",placeholder:"Spiagge o località",resultsCount:e=>e===1?"1 risultato":`${e} risultati`},labels:{nearbyBeaches:"Spiagge in zona",nearbyWithinRadius:(e,i)=>e===0?`Nessun lido entro ${i} km`:e===1?`1 lido entro ${i} km`:`${e} lidi entro ${i} km`,noNearbyWithinRadius:e=>`Nessun lido entro ${e} km.`,enableLocationNearby:"Attiva la posizione per vedere i lidi vicini.",crowdStatus:"Stato affollamento",waterStatus:"Qualità acqua",beachStatus:"Stato spiaggia",crowd:"Affollamento",water:"Acqua",beach:"Spiaggia",level:"Livello",confidence:"Affidabilità segnalazione",update:"Aggiornamento",lastUpdate:"Ultimo aggiornamento",reports:"Segnalazioni",address:"Indirizzo",hours:"Orari",usefulInfo:"Info utili",phone:"Telefono",website:"Sito",services:"Servizi",weather:"Meteo",favorites:"Preferiti",reviews:"Recensioni"},status:{live:"Aggiornato ora",recent:"Aggiornato poco fa",pred:"Stima",predLong:"In assenza di segnalazioni"},confidence:{low:"Bassa",medium:"Media",high:"Alta",inline:e=>`Affidabilità segnalazione ${e}`},crowdLevels:{1:"Vuota",2:"Poco Affollata",3:"Affollata",4:"Piena"},waterLevels:{1:"Ottima",2:"Buona",3:"Accettabile",4:"Scarsa"},beachLevels:{1:"Pulita",2:"Normale",3:"Sporca"},time:{now:"ora",justNow:"poco fa",minutesAgo:e=>`${e} min fa`,hourAgo:"1 ora fa",hoursAgo:e=>`${e} ore fa`,notAvailable:"N/A"},distance:{unknown:"Distanza non disponibile",near:"Qui vicino",mid:"In zona",far:"Più lontano"},weather:{loading:"Caricamento meteo...",unavailable:"Meteo non disponibile al momento.",updated:"Aggiornato",now:"Adesso",nextHours:"Prossime ore",temperature:"Temperatura",wind:"Vento",rainProbability:"Prob. pioggia",noRainData:"N/D",conditions:{clear:"Sereno",mainlyClear:"Poco nuvoloso",cloudy:"Nuvoloso",overcast:"Coperto",fog:"Nebbia",drizzle:"Pioviggine",rain:"Pioggia",showers:"Rovesci",thunder:"Temporale",snow:"Neve",unknown:"Variabile"}},reports:{noneRecent:"Nessuna segnalazione recente",count:e=>e===1?"1 segnalazione":`${e} segnalazioni`},report:{title:"Segnala affollamento",submitting:"Invio segnalazione...",locationSearching:"Sto cercando la tua posizione...",locationDenied:"Posizione negata. Attivala per segnalare.",locationUnavailable:"Posizione non disponibile.",locationRequired:"Attiva la posizione per segnalare.",tooFar:"Sei troppo lontano per segnalare qui. Avvicinati alla spiaggia.",remoteAllowed:"Segnalazione da remoto attiva. Puoi segnalare anche se lontano.",nearEnough:"Sei vicino alla spiaggia. Puoi segnalare.",tooSoon:"Hai già segnalato da poco. Riprova tra qualche minuto.",submitFailed:"Non riesco a salvare la segnalazione ora. Riprova tra poco.",feedUnavailable:"Dati segnalazioni non disponibili al momento. Riprova tra poco.",thanksPrompt:"✅ Grazie. Vuoi aiutare anche gli altri?",thanksSubtitle:"Condividi la segnalazione per aggiornare chi sta arrivando."},account:{requiredForFavorites:"Per salvare i preferiti devi creare un account. La navigazione dell'app resta libera.",title:"Account richiesto",subtitle:"Crea un account per salvare e ritrovare i tuoi lidi preferiti.",continueToRegister:"Crea e continua",registerTitle:"Registrazione",registerSubtitle:"Completa la registrazione e torni subito in app.",signInTitle:"Accedi",signInSubtitle:"Accedi al tuo account e torni subito in app.",forgotPasswordTitle:"Recupera password",forgotPasswordSubtitle:"Inserisci la tua email e ti inviamo il link per impostare una nuova password.",resetPasswordTitle:"Nuova password",resetPasswordSubtitle:"Imposta una nuova password sicura per il tuo account.",signInNoAccountPrompt:"Non sei ancora registrato?",signInNoAccountAction:"Registrati",forgotPasswordPrompt:"Password dimenticata?",forgotPasswordAction:"Recuperala",forgotPasswordSubmitAction:"Invia link di reset",forgotPasswordSubmittingAction:"Invio in corso...",forgotPasswordSent:"Ti abbiamo inviato una mail con il link per reimpostare la password.",backToLoginAction:"Torna al login",registerHasAccountPrompt:"Hai già un account?",registerHasAccountAction:"Accedi",personalInfoTitle:"Dati personali",credentialsTitle:"Credenziali",firstNameLabel:"Nome",lastNameLabel:"Cognome",emailLabel:"Email",passwordLabel:"Password",confirmPasswordLabel:"Conferma password",emailPlaceholder:"nome@email.com",firstNamePlaceholder:"Nome",lastNamePlaceholder:"Cognome",passwordPlaceholder:"Almeno 10 caratteri",confirmPasswordPlaceholder:"Ripeti la password",passwordHint:"Minimo 10 caratteri, con maiuscola, minuscola, numero e simbolo.",consentLabel:"Accetto termini, privacy e condizioni d'uso.",createAction:"Completa registrazione",creatingAction:"Creazione account...",signInSubmitAction:"Accedi",signingInAction:"Accesso in corso...",resetPasswordSubmitAction:"Aggiorna password",resettingPasswordAction:"Aggiornamento in corso...",resetPasswordRequestAgainPrompt:"Link non valido o scaduto?",resetPasswordRequestAgainAction:"Richiedi un nuovo link",createFailed:"Non riesco a completare la registrazione, riprova.",resetPasswordRequestFailed:"Non riesco a inviare il link di reset ora. Riprova tra poco.",resetPasswordInvalidLink:"Il link di recupero non è valido o è scaduto. Richiedine uno nuovo.",resetPasswordFailed:"Non riesco ad aggiornare la password ora. Riprova tra poco.",resetPasswordSuccess:"Password aggiornata con successo. Rientro in app in corso...",createMissingConfig:"Registrazione non disponibile: configurazione account mancante.",emailAlreadyRegistered:"Questa email risulta già registrata.",loginFailed:"Account già esistente, ma non riesco ad accedere con la password inserita.",invalidCredentials:"Email o password non corretti.",emailConfirmationRequired:"Account creato ma non ancora attivo. Conferma la mail e poi rientra in app.",favoriteSyncFailed:"Non riesco a sincronizzare i preferiti ora. Riprova tra poco.",profileTitle:"Profilo",profileAction:"Apri profilo",profileFavoritesTitle:"Lidi preferiti",profileFavoritesEmpty:"Non hai ancora salvato lidi nei preferiti.",profileOpenFavoriteAction:"Apri lido",signInAction:"Accedi",signedInAs:"Accesso attivo",signOutAction:"Esci",signOutFailed:"Non riesco a uscire ora. Riprova tra poco.",deleteAccountAction:"Elimina account",deletingAccountAction:"Eliminazione account...",deleteAccountHint:"L'eliminazione account è definitiva e rimuove anche i preferiti salvati.",deleteAccountFailed:"Non riesco a eliminare l'account ora. Riprova tra poco.",deleteAccountConfirm:"Vuoi eliminare definitivamente il tuo account e tutti i preferiti?",deleteAccountSuccess:"Account eliminato con successo.",cancelAndBack:"Torna all'app",requiredField:"Compila tutti i campi obbligatori.",invalidName:"Inserisci nome e cognome validi.",invalidEmail:"Inserisci un'email valida.",weakPassword:"Password troppo debole. Segui i requisiti indicati sotto il campo.",passwordMismatch:"Le password non coincidono.",consentRequired:"Devi accettare termini e privacy per continuare.",created:"Account creato. Ora puoi salvare i preferiti."},location:{permissionDenied:"Permesso posizione negato.",fetchError:"Non riesco a leggere la posizione.",notSupported:"La posizione non è supportata su questo dispositivo.",toastUnavailable:'Posizione non disponibile. Attiva la posizione per usare "La mia posizione".',centered:"Posizione centrata.",centeredStale:"Posizione centrata. Aggiorno la precisione..."},empty:{notAvailable:"Non disponibile",toConfirm:"Da confermare",loadingReviews:"Caricamento recensioni...",noReviews:"Nessuna recensione ancora. Sii il primo!"},share:{confidenceLabel:"Affidabilità segnalazione",updatedLabel:"Aggiornato",reportsLabel:"Segnalazioni",preparing:"Preparazione...",shareText:(e,i)=>`${e} • Affidabilità segnalazione ${i}`},debug:{title:"Debug",editPositions:"Modifica posizioni spiagge",selectedBeach:"Spiaggia selezionata",none:"nessuna",resetOverride:"Ripristina posizione selezionata",resetOverrides:"Reset pin overrides",overrideWarning:e=>`Local pin overrides are active (${e}). These override seed coordinates. Use Reset to validate seed.`,positionSaved:"Posizione salvata",lat:"lat",lng:"lng",version:"v1",deeplink:"Deep link",deeplinkMatched:"Match spot",deeplinkParams:"Parametri",pending:"in attesa",yes:"sì",no:"no",attribution:"Attribuzione",eventsCount:"Eventi salvati",copyExport:"Copia export JSON",clearEvents:"Pulisci eventi",clearAttribution:"Pulisci attribuzione",exportCopied:"Export copiato",exportFailed:"Copia non riuscita",eventsCleared:"Eventi cancellati",attributionCleared:"Attribuzione cancellata",perfTitle:"Performance",perfReset:"Reset",perfClusterLast:e=>`Clustering: ${e.toFixed(1)}ms`,perfClusterMeta:(e,i,a)=>`cluster=${e} · singoli=${i} · zoom=${a??"?"}`,perfIconCache:e=>`Cache icone: ${e}`,perfRender:(e,i)=>`${e}: ${i??0}`}},N="/assets/logo-Cf_7y5Tb.png",g="https://where2beach.com",A=e=>e.replace(/\/+$/,""),b=()=>{const e="https://where2beach.com".trim();return e?A(e):g},m=b(),I=(()=>{try{return new URL(m).hostname}catch{return new URL(g).hostname}})(),f=`https://ucfbrwfgssqtjzfxnvrj.supabase.co
`.trim(),w=`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVjZmJyd2Znc3NxdGp6ZnhudnJqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2MDI4NTgsImV4cCI6MjA4NTE3ODg1OH0.bLh7ITuw2Mnf1TWtukjnLEO91lms9ZoR-AGKbF5iv-E
`.trim();let l=null;const h=()=>!!(f&&w),t=()=>h()?l||(l=v(f,w,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}),l):null,u="user_favorites",k=()=>{const e=["/api/account/delete"];if(typeof window>"u")return e;const i=window.location.origin.replace(/\/+$/,""),a=m.replace(/\/+$/,"");return i!==a&&e.push(`${a}/api/account/delete`),e},d=(e,...i)=>{const a=e.user_metadata;if(!a)return"";for(const n of i){const o=a[n];if(typeof o=="string"&&o.trim().length>0)return o.trim()}return""},s=e=>!e?.id||!e.email?null:{id:e.id,email:e.email,firstName:d(e,"first_name","firstName"),lastName:d(e,"last_name","lastName")},z=e=>{const i=(e??"").toLowerCase();return i.includes("already registered")||i.includes("already been registered")?"email_exists":i.includes("password")?"weak_password":i.includes("email")?"invalid_email":i.includes("network")?"network":"unknown"},p=(e,i)=>{const a=(i??"").toLowerCase();return e==="PGRST301"||e==="42501"||a.includes("jwt")||a.includes("permission denied")||a.includes("not authenticated")?"unauthorized":a.includes("network")?"network":"unknown"},P=e=>{const i=(e??"").toLowerCase();return i.includes("invalid login credentials")?"invalid_credentials":i.includes("network")?"network":"unknown"},S=e=>{const i=(e??"").toLowerCase();return i.includes("email")?"invalid_email":i.includes("network")?"network":"unknown"},C=e=>{const i=(e??"").toLowerCase();return i.includes("auth session missing")||i.includes("invalid token")||i.includes("jwt")||i.includes("token has expired")?"unauthorized":i.includes("password")?"weak_password":i.includes("network")?"network":"unknown"},y=async()=>{const e=t();if(!e)return null;const{data:i,error:a}=await e.auth.getUser();return a?null:s(i.user)},_=e=>{const i=t();if(!i)return e(null),()=>{};const{data:a}=i.auth.onAuthStateChange((n,o)=>{e(s(o?.user??null))});return()=>a.subscription.unsubscribe()},E=async e=>{const i=t();if(!i)return{ok:!1,code:"missing_config"};const{data:a,error:n}=await i.auth.signUp({email:e.email.trim().toLowerCase(),password:e.password,options:{data:{first_name:e.firstName.trim(),last_name:e.lastName.trim()}}});if(n)return{ok:!1,code:z(n.message)};const o=s(a.user);return o?{ok:!0,account:o,sessionReady:!!a.session}:{ok:!1,code:"unknown"}},T=async e=>{const i=t();if(!i)return{ok:!1,code:"missing_config"};const{data:a,error:n}=await i.auth.signInWithPassword({email:e.email.trim().toLowerCase(),password:e.password});if(n)return{ok:!1,code:P(n.message)};const o=s(a.user);return o?{ok:!0,account:o,sessionReady:!!a.session}:{ok:!1,code:"unknown"}},F=async e=>{const i=t();if(!i)return{ok:!1,code:"missing_config"};const{error:a}=await i.auth.resetPasswordForEmail(e.email.trim().toLowerCase(),{redirectTo:e.redirectTo});return a?{ok:!1,code:S(a.message)}:{ok:!0}},B=async e=>{const i=t();if(!i)return{ok:!1,code:"missing_config"};const{data:a,error:n}=await i.auth.updateUser({password:e});if(n)return{ok:!1,code:C(n.message)};const o=s(a.user);return o?{ok:!0,account:o}:{ok:!1,code:"unknown"}},$=async e=>{if(!e)return[];const i=t();if(!i)return[];const{data:a,error:n}=await i.from(u).select("beach_id").eq("user_id",e);if(n||!Array.isArray(a))return[];const o=a.map(r=>typeof r.beach_id=="string"?r.beach_id:null).filter(r=>!!r);return Array.from(new Set(o))},U=async(e,i,a)=>{const n=t();if(!n)return{ok:!1,code:"missing_config"};if(a){const{error:r}=await n.from(u).upsert({user_id:e,beach_id:i},{onConflict:"user_id,beach_id"});return r?{ok:!1,code:p(r.code,r.message)}:{ok:!0}}const{error:o}=await n.from(u).delete().eq("user_id",e).eq("beach_id",i);return o?{ok:!1,code:p(o.code,o.message)}:{ok:!0}},O=async()=>{const e=t();if(!e)return{ok:!1,code:"missing_config"};const{error:i}=await e.auth.signOut();return i?i.message.toLowerCase().includes("network")?{ok:!1,code:"network"}:{ok:!1,code:"unknown"}:{ok:!0}},q=async()=>{const e=t();if(!e)return{ok:!1,code:"missing_config"};const{data:i,error:a}=await e.auth.getSession();if(a||!i.session?.access_token)return{ok:!1,code:"unauthorized"};const n=k();let o=!1;for(const r of n)try{const c=await fetch(r,{method:"POST",headers:{Authorization:`Bearer ${i.session.access_token}`}});if(c.ok)return{ok:!0};if(c.status===401)return{ok:!1,code:"unauthorized"};if(c.status===404||c.status===405)continue;return{ok:!1,code:"unknown"}}catch{o=!0}return o?{ok:!1,code:"network"}:{ok:!1,code:"unknown"}};export{m as P,L as S,y as a,U as b,O as c,q as d,N as e,T as f,t as g,E as h,I as i,$ as l,F as r,_ as s,B as u};
