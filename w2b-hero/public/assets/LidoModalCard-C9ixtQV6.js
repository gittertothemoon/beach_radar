import{r as d,j as e}from"./vendor-react-CVtZf1lr.js";import{S as s}from"./account-bn8wqSlT.js";import{f as H,c as $,a as z,b as B,d as w}from"./App-E8NZcKxx.js";import"./vendor-supabase-DxPc9Yn3.js";import"./vendor-misc-CRXyoZRO.js";import"./index-qWqqj5HS.js";import"./vendor-leaflet-KW0ACPqV.js";const K=t=>{switch(t){case"LIVE":return"bg-emerald-500/30 text-emerald-100 border-emerald-300/60";case"RECENT":return"bg-amber-400/30 text-amber-100 border-amber-300/60";default:return"bg-slate-400/25 text-slate-100 border-slate-300/50"}},T=(t,r)=>{if(t===r)return!0;if(!t||!r)return!t&&!r;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a+=1)if(t[a]!==r[a])return!1;return!0},k=t=>t===null?s.weather.noRainData:`${Math.round(t)}%`,_=(t,r)=>{if(t===r)return!0;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a+=1)if(t[a].ts!==r[a].ts||t[a].temperatureC!==r[a].temperatureC||t[a].rainProbability!==r[a].rainProbability||t[a].weatherCode!==r[a].weatherCode||t[a].conditionLabel!==r[a].conditionLabel)return!1;return!0},F=(t,r)=>t===r?!0:!t||!r?!1:t.fetchedAt===r.fetchedAt&&t.expiresAt===r.expiresAt&&t.timezone===r.timezone&&t.current.ts===r.current.ts&&t.current.temperatureC===r.current.temperatureC&&t.current.windKmh===r.current.windKmh&&t.current.rainProbability===r.current.rainProbability&&t.current.weatherCode===r.current.weatherCode&&t.current.isDay===r.current.isDay&&t.current.conditionLabel===r.current.conditionLabel&&_(t.nextHours,r.nextHours),I=({beach:t,isOpen:r,now:a,isFavorite:l,weather:n,weatherLoading:C,weatherUnavailable:L,reviews:u=[],reviewsLoading:A=!1,onClose:x,onToggleFavorite:E,onReport:R,onShare:P,onWriteReview:f})=>{const h=d.useRef(null),j=d.useRef(null),S=t.state==="PRED";if(d.useEffect(()=>{if(!r)return;const i=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=i}},[r]),d.useEffect(()=>{if(!r)return;j.current?.focus();const i=h.current?.querySelectorAll("button, [href], input, select, textarea, [tabindex]:not([tabindex='-1'])"),b=o=>{if(o.key==="Escape"){x();return}if(o.key!=="Tab"||!i||i.length===0)return;const v=i[0],N=i[i.length-1];o.shiftKey&&document.activeElement===v?(o.preventDefault(),N.focus()):!o.shiftKey&&document.activeElement===N&&(o.preventDefault(),v.focus())};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[r,x]),!r)return null;const M=t.address?.trim(),D=t.hours?.trim(),m=t.phone?.trim(),c=t.website?.trim(),p=t.services?.filter(Boolean),y=Number.isFinite(t.lat)&&Number.isFinite(t.lng)?`https://www.google.com/maps?q=${t.lat},${t.lng}`:null,g=c?c.startsWith("http")?c:`https://${c}`:null;return e.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 px-4 py-[calc(env(safe-area-inset-top)+16px)]",onClick:x,children:e.jsxs("div",{ref:h,role:"dialog","aria-modal":"true","aria-label":s.aria.beachDetails(t.name),"data-testid":"lido-modal",onClick:i=>i.stopPropagation(),className:"flex max-h-[80svh] w-[min(92vw,560px)] flex-col overflow-hidden rounded-[18px] contrast-guard",children:[e.jsxs("div",{className:"flex items-start justify-between px-6 pt-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex rounded-full border px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.08em] ${K(t.state)}`,children:H(t.state)}),S?e.jsx("span",{className:"text-[11px] br-text-tertiary",children:s.status.predLong}):null]}),e.jsxs("h2",{className:"mt-3 flex items-start gap-2 text-[22px] font-semibold tracking-[-0.01em] br-text-primary",children:[e.jsx("span",{className:"min-w-0 flex-1 break-words",children:t.name}),e.jsx("button",{type:"button",onClick:E,"aria-label":s.aria.toggleFavoriteBeach(t.name,l),"data-testid":"favorite-toggle",className:`br-press inline-flex h-8 w-8 min-h-8 min-w-8 shrink-0 items-center justify-center rounded-full border transition focus-visible:outline focus-visible:outline-1 focus-visible:outline-[color:var(--focus-ring)] focus-visible:outline-offset-1 ${l?"border-amber-300/55 bg-amber-400/20 text-amber-100":"border-white/18 bg-black/40 br-text-tertiary"}`,children:e.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"h-4 w-4 shrink-0",fill:l?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.8",children:e.jsx("path",{d:"M12 2.7l2.8 5.67 6.25.91-4.53 4.42 1.07 6.24L12 17.06 6.4 19.94l1.07-6.24-4.53-4.42 6.25-.91L12 2.7z"})})})]}),e.jsx("p",{className:"text-[13px] br-text-secondary",children:t.region})]}),e.jsx("button",{ref:j,onClick:x,"aria-label":s.aria.closeBeachDetails,className:"br-press rounded-full border border-white/15 bg-black/40 px-3 py-1.5 text-[11px] font-semibold br-text-primary focus-visible:outline focus-visible:outline-1 focus-visible:outline-[color:var(--focus-ring)] focus-visible:outline-offset-1",children:s.actions.close})]}),e.jsxs("div",{className:"flex-1 space-y-4 overflow-y-auto px-6 pb-6 pt-4",children:[e.jsxs("div",{className:"rounded-[12px] border border-white/15 bg-black/30 p-4 text-sm br-text-primary backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:[e.jsx("span",{children:s.labels.crowdStatus}),e.jsx("span",{className:"text-[11px] font-semibold br-text-primary",children:$(t.crowdLevel)})]}),t.waterCondition?e.jsxs("div",{className:"mt-3 flex items-center justify-between text-[11px] uppercase tracking-[0.12em] br-text-tertiary border-t border-white/5 pt-3",children:[e.jsx("span",{children:s.labels.waterStatus}),e.jsx("span",{className:"text-[11px] font-semibold br-text-primary",children:s.waterLevels[t.waterCondition]})]}):null,t.beachCondition?e.jsxs("div",{className:"mt-3 flex items-center justify-between text-[11px] uppercase tracking-[0.12em] br-text-tertiary border-t border-white/5 pt-3",children:[e.jsx("span",{children:s.labels.beachStatus}),e.jsx("span",{className:"text-[11px] font-semibold br-text-primary",children:s.beachLevels[t.beachCondition]})]}):null,e.jsxs("div",{className:"mt-3 grid gap-2 border-t border-white/5 pt-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"br-text-tertiary",children:s.labels.confidence}),e.jsx("span",{className:"font-semibold",children:z(t.confidence)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"br-text-tertiary",children:s.labels.lastUpdate}),e.jsx("span",{className:"font-semibold",children:B(t.updatedAt,a)})]})]})]}),e.jsxs("div",{"data-testid":"lido-weather",className:"rounded-[12px] border border-white/15 bg-black/30 p-4 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:[e.jsx("span",{children:s.labels.weather}),n?e.jsxs("span",{className:"font-semibold br-text-primary",children:[s.weather.updated," ",w(n.current.ts,n.timezone)]}):null]}),n?e.jsxs("div",{className:"mt-3 grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-[13px] br-text-primary",children:n.current.conditionLabel}),e.jsxs("div",{className:"text-[18px] font-semibold br-text-primary",children:[Math.round(n.current.temperatureC),"°C"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-[12px]",children:[e.jsx("span",{className:"br-text-tertiary",children:s.weather.wind}),e.jsxs("span",{className:"font-semibold br-text-primary",children:[Math.round(n.current.windKmh)," km/h"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-[12px]",children:[e.jsx("span",{className:"br-text-tertiary",children:s.weather.rainProbability}),e.jsx("span",{className:"font-semibold br-text-primary",children:k(n.current.rainProbability)})]}),n.nextHours.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:s.weather.nextHours}),e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:n.nextHours.map(i=>e.jsxs("div",{className:"rounded-lg border border-white/10 bg-black/20 px-2 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-[11px] br-text-primary",children:[e.jsx("span",{children:w(i.ts,n.timezone)}),e.jsxs("span",{children:[Math.round(i.temperatureC),"°C"]})]}),e.jsx("div",{className:"mt-1 text-[10px] br-text-secondary",children:i.conditionLabel}),e.jsxs("div",{className:"mt-1 text-[10px] br-text-tertiary",children:[s.weather.rainProbability,":"," ",k(i.rainProbability)]})]},i.ts))})]}):null]}):C?e.jsx("p",{className:"mt-3 text-[13px] br-text-secondary",children:s.weather.loading}):L?e.jsx("p",{className:"mt-3 text-[13px] br-text-tertiary",children:s.weather.unavailable}):e.jsx("p",{className:"mt-3 text-[13px] br-text-secondary",children:s.weather.loading})]}),e.jsxs("div",{className:"rounded-[12px] border border-white/15 bg-black/30 p-4 backdrop-blur-sm",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:s.labels.address}),e.jsx("p",{className:"mt-2 text-[13px] br-text-primary",children:M||s.empty.notAvailable}),y?e.jsx("a",{href:y,target:"_blank",rel:"noreferrer",className:"mt-2 inline-flex text-[12px] font-semibold br-text-primary",children:s.actions.openInMaps}):null]}),e.jsxs("div",{className:"rounded-[12px] border border-white/15 bg-black/30 p-4 backdrop-blur-sm",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:s.labels.hours}),e.jsx("p",{className:"mt-2 text-[13px] br-text-primary",children:D||s.empty.toConfirm})]}),e.jsxs("div",{className:"rounded-[12px] border border-white/15 bg-black/30 p-4 backdrop-blur-sm",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:s.labels.usefulInfo}),e.jsxs("div",{className:"mt-3 grid gap-2 text-[13px] br-text-primary",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"br-text-tertiary",children:s.labels.phone}),m?e.jsx("a",{href:`tel:${m}`,className:"font-semibold br-text-primary",children:m}):e.jsx("span",{className:"font-semibold br-text-tertiary",children:s.empty.notAvailable})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"br-text-tertiary",children:s.labels.website}),g?e.jsx("a",{href:g,target:"_blank",rel:"noreferrer",className:"font-semibold br-text-primary",children:c}):e.jsx("span",{className:"font-semibold br-text-tertiary",children:s.empty.notAvailable})]})]}),e.jsx("div",{className:"mt-3",children:p&&p.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(i=>e.jsx("span",{className:"rounded-full border border-white/20 bg-black/40 px-3 py-1 text-[11px] font-semibold br-text-primary",children:i},i))}):e.jsx("p",{className:"text-[13px] br-text-tertiary",children:s.empty.notAvailable})})]}),e.jsxs("div",{className:"rounded-[12px] border border-white/15 bg-black/30 p-4 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-[0.12em] br-text-tertiary",children:s.labels?.reviews}),f&&e.jsx("button",{onClick:f,className:"br-press text-[11px] font-semibold text-sky-400 hover:text-sky-300 transition",children:s.actions?.writeReview})]}),e.jsx("div",{className:"mt-4 space-y-4",children:A?e.jsx("p",{className:"text-[13px] text-slate-400 text-center py-2",children:s.empty?.loadingReviews}):u.length>0?u.map(i=>e.jsxs("div",{className:"border-b border-white/10 pb-4 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[12px] font-semibold text-slate-200",children:i.authorName}),e.jsx("div",{className:"flex",children:Array.from({length:5}).map((b,o)=>e.jsx("svg",{viewBox:"0 0 24 24",fill:o<i.rating?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",className:`w-3.5 h-3.5 ${o<i.rating?"text-amber-400":"text-slate-600"}`,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"})},o))})]}),e.jsx("span",{className:"text-[10px] text-slate-500 shrink-0",children:new Date(i.createdAt).toLocaleDateString("it-IT",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsx("p",{className:"text-[13px] text-slate-300 leading-relaxed break-words whitespace-pre-wrap",children:i.content})]},i.id)):e.jsx("p",{className:"text-[13px] text-slate-500 text-center py-2",children:s.empty?.noReviews})})]})]}),e.jsx("div",{className:"br-hairline border-t bg-black/40 px-6 pb-[calc(env(safe-area-inset-bottom)+16px)] pt-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:R,"data-testid":"report-cta",className:"br-press rounded-[12px] border border-white/25 bg-black/50 px-4 py-3 text-[14px] font-semibold text-slate-50 shadow-[0_10px_24px_rgba(0,0,0,0.45)] backdrop-blur-sm focus-visible:outline focus-visible:outline-1 focus-visible:outline-[color:var(--focus-ring)] focus-visible:outline-offset-1",children:s.actions.report}),e.jsx("button",{onClick:P,className:"br-press rounded-[12px] border border-white/18 bg-black/40 px-4 py-3 text-[14px] font-semibold br-text-primary backdrop-blur-sm focus-visible:outline focus-visible:outline-1 focus-visible:outline-[color:var(--focus-ring)] focus-visible:outline-offset-1",children:s.actions.share})]})})]})})},W=(t,r)=>{if(t.isOpen!==r.isOpen||t.now!==r.now||t.isFavorite!==r.isFavorite||t.weatherLoading!==r.weatherLoading||t.weatherUnavailable!==r.weatherUnavailable||!F(t.weather,r.weather)||t.onClose!==r.onClose||t.onToggleFavorite!==r.onToggleFavorite||t.onReport!==r.onReport||t.onShare!==r.onShare)return!1;const a=t.beach,l=r.beach;return a.id===l.id&&a.name===l.name&&a.region===l.region&&a.state===l.state&&a.crowdLevel===l.crowdLevel&&a.waterCondition===l.waterCondition&&a.beachCondition===l.beachCondition&&a.confidence===l.confidence&&a.updatedAt===l.updatedAt&&a.reportsCount===l.reportsCount&&a.lat===l.lat&&a.lng===l.lng&&a.address===l.address&&a.hours===l.hours&&a.phone===l.phone&&a.website===l.website&&T(a.services,l.services)},Z=d.memo(I,W);export{Z as default};
